(this["webpackJsonpstarter-app"]=this["webpackJsonpstarter-app"]||[]).push([[0],{36:function(e,t,s){},37:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(22),r=s.n(n),i=s(2),l=s(3),o=s(5),j=s.p+"static/media/logo.03234717.svg",d=s(0),u=function(e){var t=e.children,s=Object(a.useRef)(),c=Object(a.useRef)(),n=Object(l.h)(),r=Object(a.useState)(0),u=Object(i.a)(r,2),b=u[0],h=u[1],m=Object(a.useState)(0),O=Object(i.a)(m,2),_=O[0],x=O[1];return Object(a.useEffect)((function(){var e=s.current.querySelector(".header__nav-link--active");e&&(h(e.offsetLeft),x(e.offsetWidth))}),[n]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("header",{className:"header",children:Object(d.jsxs)("div",{className:"header__container container",children:[Object(d.jsx)(o.b,{className:"header__logo",to:"/",children:Object(d.jsx)("img",{className:"header__logo-img",src:j,alt:""})}),Object(d.jsxs)("nav",{className:"header__nav",ref:s,children:[Object(d.jsx)("span",{ref:c,className:"header__indicator",style:{left:b+"px",width:_+"px"}}),Object(d.jsxs)("ul",{className:"header__nav-list",children:[Object(d.jsx)("li",{className:"header__nav-item",children:Object(d.jsx)(o.c,{exact:!0,className:"header__nav-link",activeClassName:"header__nav-link--active",to:"/",children:"Admin pannel"})}),Object(d.jsx)("li",{className:"header__nav-item",children:Object(d.jsx)(o.c,{exact:!0,className:"header__nav-link",activeClassName:"header__nav-link--active",to:"/users",children:"Users"})})]})]})]})}),Object(d.jsx)("main",{children:t})]})},b=Object(a.createContext)(null);function h(e){var t=e.children,s=Object(a.useState)(window.localStorage.getItem("token")),c=Object(i.a)(s,2),n=c[0],r=c[1];return Object(a.useEffect)((function(){n?window.localStorage.setItem("token",n):window.localStorage.removeItem("token")}),[n]),Object(d.jsx)(b.Provider,{value:{state:n,setState:r},children:t})}var m=function(e){var t=Object(a.useContext)(b);return e?[t.setState]:[t.state,t.setState]},O=s(9),_=s(12);var x=function(e){var t=e.children,s=Object(_.a)(e,["children"]),a=m(!1);return Object(i.a)(a,1)[0]?Object(d.jsx)(l.b,Object(O.a)(Object(O.a)({},s),{},{children:t})):Object(d.jsx)(l.a,{to:"/login"})};var p=function(e){var t=e.children,s=Object(_.a)(e,["children"]),a=Object(l.h)().pathname,c=m(!1);return Object(i.a)(c,1)[0]&&"/login"===a?Object(d.jsx)(l.a,{to:"/"}):Object(d.jsx)(l.b,Object(O.a)(Object(O.a)({},s),{},{children:t}))},v=s(24),f=s(10),N=s.n(f),g=s(15),w="token";function S(){return k.apply(this,arguments)}function k(){return(k=Object(g.a)(N.a.mark((function e(){return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem(w);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y="https://www.api.rajabov.uz";function T(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.data,a=t.token,c=t.headers,n=Object(_.a)(t,["data","token","headers"]),r=Object(O.a)({method:s?"POST":"GET",body:s?JSON.stringify(s):void 0,headers:Object(O.a)({Authorization:a?"Bearer ".concat(a):void 0,"Content-Type":s?"application/json":void 0},c)},n);return window.fetch("".concat(y,"/").concat(e),r).then(function(){var e=Object(g.a)(N.a.mark((function e(t){var s;return N.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.status){e.next=5;break}return e.next=3,S();case 3:return window.location.assign(window.location),e.abrupt("return",Promise.reject({message:"Please re-authenticate.",code:401}));case 5:return e.next=7,t.json();case 7:if((s=e.sent).success||401!==s.code){e.next=12;break}return S(),window.location.assign(window.location),e.abrupt("return",Promise.reject({message:"Please re-authenticate.",code:401}));case 12:if(!t.ok){e.next=16;break}return e.abrupt("return",s);case 16:return e.abrupt("return",Promise.reject(s));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}var I=s.p+"static/media/calendar-event-line.af420fa4.svg",C=s.p+"static/media/trash.d37c4393.svg",P=function(e){var t=e.data,s=Object(a.useState)(t.isActive),c=Object(i.a)(s,2),n=c[0],r=c[1];return Object(d.jsxs)("li",{className:"events__item",style:{opacity:n?"1":"0.6"},children:[Object(d.jsxs)("div",{className:"events__item-content",children:[Object(d.jsx)("h3",{className:"events__item-title",children:Object(d.jsx)(o.b,{to:"/users?eventId="+t.id,children:t.title})}),Object(d.jsx)("p",{className:"events__item-desc",children:t.desc})]}),Object(d.jsxs)("div",{className:"events__item-info",children:[Object(d.jsxs)("time",{className:"events__item-info-item events__item-date",children:[Object(d.jsx)("img",{src:I,alt:"user"}),t.orginizeDate]}),n?Object(d.jsx)("button",{onClick:function(){T("contests/deactivate/".concat(t.id),{method:"PUT",token:localStorage.getItem("token")}).then((function(){r(!1)}))},className:"events__item-delete",children:Object(d.jsxs)("span",{children:[Object(d.jsx)("img",{src:C,alt:""}),"O'chirish"]})}):null]})]})},M=function(){var e=Object(a.useState)([]),t=Object(i.a)(e,2),s=t[0],c=t[1],n=Object(a.useState)(!1),r=Object(i.a)(n,2),l=r[0],o=r[1],j=Object(a.useState)(""),u=Object(i.a)(j,2),b=u[0],h=u[1],m=Object(a.useRef)(),O=Object(a.useState)(!1),_=Object(i.a)(O,2),x=_[0],p=_[1],f=Object(a.useState)(""),N=Object(i.a)(f,2),g=N[0],w=N[1];Object(a.useEffect)((function(){o(!0),h(""),T("contests",{token:localStorage.getItem("token")}).then((function(e){h(""),o(!1),c(e.data)})).catch((function(e){o(!1),h(e.message)}))}),[]);return Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("section",{className:"section",children:[Object(d.jsx)("h2",{className:"section__title",children:"Yangi tanlov"}),Object(d.jsxs)("form",{ref:m,onSubmit:function(e){e.preventDefault();var t=m.current,a=t.title.value,n=t.img.files,r=t.desc.value,i=t.prize.value,l=t.sponsor.value,o=t.winners.value,j=t.datetext.value;if(a&&r&&i&&l&&o&&j){var d=new FormData;d.append("winnerCount",o),d.append("sponsorTgId",l),d.append("title",a),d.append("orginizeDate",j),d.append("desc",r),d.append("gift",i),d.append("image",n[0]),p(!0),fetch("http://rajabov.uz:8000/api/contests",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("token")},body:d}).then((function(e){return p(!1),e.json()})).then((function(e){return e.success?(m.current.reset(),w(""),void c([].concat(Object(v.a)(s),[e.data]))):Promise.reject(e)})).catch((function(e){p(!1),w(e.message)}))}},method:"POST",action:"#",className:"new-event",children:[Object(d.jsxs)("label",{className:"new-event__label",children:["Tanlov nomi",Object(d.jsx)("input",{className:"new-event__input",id:"title",type:"text",placeholder:"some text"})]}),Object(d.jsxs)("label",{className:"new-event__label",children:["Tanlov rasmi",Object(d.jsx)("input",{className:"new-event__input",id:"img",type:"file",placeholder:"Tanlov rasmini tanlang"})]}),Object(d.jsxs)("label",{className:"new-event__label",children:["Tanlov tavisifi",Object(d.jsx)("textarea",{className:"new-event__input",id:"desc",cols:"20",rows:"10"})]}),Object(d.jsxs)("label",{className:"new-event__label",children:["Sovg'a",Object(d.jsx)("input",{className:"new-event__input",id:"prize",type:"text",placeholder:"some text"})]}),Object(d.jsxs)("label",{className:"new-event__label",children:["Tanlov homiysi",Object(d.jsx)("input",{className:"new-event__input",id:"sponsor",type:"text",placeholder:"some text"})]}),Object(d.jsxs)("div",{className:"new-event__group",children:[Object(d.jsxs)("label",{className:"new-event__label",children:["G\u2019oliblar soni",Object(d.jsx)("input",{className:"new-event__input",id:"winners",type:"number",placeholder:"some text"})]}),Object(d.jsxs)("label",{className:"new-event__label",children:["Tanlov vaqti",Object(d.jsx)("input",{className:"new-event__input",id:"datetext",type:"text",placeholder:"some text"})]})]}),Object(d.jsxs)("div",{className:"new-event__actions",children:[Object(d.jsx)("button",{className:"new-event__cancel submit-btn submit-btn--outlined",type:"reset",children:"Bekor qilish"}),Object(d.jsx)("button",{disabled:x,className:"submit-btn new-event__submit",type:"submit",children:x?"Sending...":"Send"})]}),g&&Object(d.jsx)("p",{children:g})]})]}),Object(d.jsxs)("section",{className:"section",children:[Object(d.jsx)("h2",{className:"section__title",children:"Barcha tadbirlar"}),l&&Object(d.jsx)("p",{style:{fontStyle:"italic"},children:"Tadbirlar kelyapti..."}),b&&Object(d.jsx)("p",{children:b}),Object(d.jsx)("ul",{className:"events",children:s.map((function(e){return Object(d.jsx)(P,{data:e,setContests:c},e.id)}))})]})]})},z=function(){var e=m(!0),t=Object(i.a)(e,1)[0],s=Object(l.g)(),c=Object(a.useState)(""),n=Object(i.a)(c,2),r=n[0],o=n[1],u=Object(a.useState)(""),b=Object(i.a)(u,2),h=b[0],O=b[1],_=Object(a.useState)(!1),x=Object(i.a)(_,2),p=x[0],v=x[1],f=Object(a.useState)(""),N=Object(i.a)(f,2),g=N[0],w=N[1];return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:"auth container",children:[Object(d.jsx)("img",{className:"auth__logo",src:j,alt:""}),Object(d.jsxs)("div",{className:"auth__content",children:[Object(d.jsx)("h1",{className:"auth__title",children:"Login"}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),r.trim()&&h.trim()&&(w(""),v(!0),T("admin/login",{data:{phoneNumber:r.trim(),password:h.trim()}}).then((function(e){v(!1),t(e.token),s.push("/")})).catch((function(e){v(!1),w(e.message)})))},action:"#",method:"post",children:[Object(d.jsx)("input",{placeholder:"+998901234567",className:"auth__field field",value:r,onChange:function(e){return o(e.target.value)},type:"text"}),Object(d.jsx)("input",{placeholder:"12345678",className:"auth__field field",value:h,onChange:function(e){return O(e.target.value)},type:"password"}),Object(d.jsx)("button",{disabled:p,className:"auth__submit submit-btn",type:"submit",children:p?"Logging in...":"Login"}),g&&Object(d.jsx)("p",{style:{color:"red"},children:g})]})]})]})})},E=function(e){var t=e.data,s=t.firstName,a=t.telegramId,c=t.phoneNumber,n=t.bithYear,r=t.gender,i=(new Date).getFullYear(),l=n?i-n:null;return Object(d.jsxs)("tr",{className:"users__row",children:[Object(d.jsxs)("td",{className:"users__col",children:[Object(d.jsx)("p",{className:"user__user-name",children:s||"Ma'lumot kiritilmagan"}),Object(d.jsxs)("span",{className:"users__user-id",children:["#",a||"Ma'lumot kiritilmagan"]})]}),Object(d.jsx)("td",{className:"users__col",children:Object(d.jsx)("a",{className:"users__user-phone",href:"tel:"+c,children:c||"Ma'lumot kiritilmagan"})}),Object(d.jsx)("td",{className:"users__col",children:l||"Ma'lumot kiritilmagan"}),Object(d.jsx)("td",{className:"users__col",children:r||"Ma'lumot kiritilmagan"})]})},R=function(e){return e||"Ma'lumot kiritilmagan"},D=function(e){var t=e.winners,s=e.setModalUsers;return Object(d.jsx)("div",{className:"winners",onClick:function(e){e.target.matches(".winners")&&s(null)},children:Object(d.jsx)("div",{className:"winners__content",children:Object(d.jsx)("div",{className:"users",children:Object(d.jsxs)("table",{className:"users__table",children:[Object(d.jsx)("caption",{className:"users__title",children:"Ro\u2019yxatdan o\u2019tganlar (378)"}),Object(d.jsx)("tbody",{children:t&&t.map((function(e){return Object(d.jsxs)("tr",{className:"users__row",children:[Object(d.jsx)("td",{className:"users__col",children:Object(d.jsx)("p",{className:"users__user-name",children:R(e.firstName)})}),Object(d.jsx)("td",{children:R(e.telegramId)}),Object(d.jsx)("td",{className:"users__col",children:Object(d.jsx)("a",{className:"users__user-phone",href:"tel:"+e.phoneNumber,children:R(e.phoneNumber)})})]},e.id)}))})]})})})})};var U=s.p+"static/media/refresh-line.64a9038e.svg";var q=function(){return new URLSearchParams(Object(l.h)().search)},B=function(){var e=q().get("eventId"),t=Object(a.useState)(null),s=Object(i.a)(t,2),c=s[0],n=s[1],r=Object(a.useState)(!1),l=Object(i.a)(r,2),o=l[0],j=l[1],u=Object(a.useState)([]),b=Object(i.a)(u,2),h=b[0],m=b[1],O=Object(a.useState)(!1),_=Object(i.a)(O,2),x=_[0],p=_[1],v=Object(a.useState)(""),f=Object(i.a)(v,2),N=f[0],g=f[1],w=Object(a.useState)([]),S=Object(i.a)(w,2),k=S[0],y=S[1],I=Object(a.useState)(e||"0"),C=Object(i.a)(I,2),P=C[0],M=C[1],z=function(e,t){var s=Object(a.useState)(e),c=Object(i.a)(s,2),n=c[0],r=c[1];return Object(a.useEffect)((function(){var s=setTimeout((function(){r(e)}),t);return function(){clearTimeout(s)}}),[e,t]),n}(P,250);Object(a.useEffect)((function(){T("contests",{token:localStorage.getItem("token")}).then((function(e){m(e.data)}))}),[]),Object(a.useEffect)((function(){"0"!==z&&(p(!0),g(""),T("users/contest/".concat(z),{token:localStorage.getItem("token")}).then((function(e){p(!1),y(e.data),g("")})).catch((function(e){g(e.message),p(!1)})))}),[z]);var R=Object(a.useMemo)((function(){return h&&h.find((function(e){return z===e.id}))}),[z]);return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"container",children:[Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"0"!==P&&(j(!0),T("winners/".concat(P),{token:localStorage.getItem("token")}).then((function(e){j(!1),n(e.data)})).catch((function(){j(!1)})))},className:"choose-winner",children:[Object(d.jsxs)("div",{className:"choose-winner__block choose-winner__event",children:[Object(d.jsx)("label",{className:"choose-winner__title",children:"Tadbir"}),Object(d.jsxs)("select",{className:"field choose-winner__select",defaultValue:P,onChange:function(e){M(e.target.value)},children:[Object(d.jsx)("option",{value:"0",disabled:!0,children:"Tadbirni tanlang"}),h.map((function(e){return Object(d.jsx)("option",{value:e.id,children:e.title},e.id)}))]})]}),Object(d.jsxs)("div",{className:"choose-winner__block choose-winner__winner",children:[Object(d.jsx)("h2",{className:"choose-winner__title",children:"G\u2019oliblarni aniqlash"}),Object(d.jsxs)("div",{className:"choose-winner__right-content",children:[Object(d.jsx)("output",{className:"choose-winner__input field",children:R&&R.winnerCount}),Object(d.jsx)("button",{disabled:o,className:"submit-btn",type:"submit",children:Object(d.jsxs)("span",{children:[Object(d.jsx)("img",{className:o?"choose-winner__refresh-icon":"",src:U,alt:""}),o?"Randomlanyapti":"Randomlash"]})})]})]})]}),Object(d.jsxs)("div",{className:"users",children:[x&&Object(d.jsx)("p",{style:{fontStyle:"italic"},children:"Userlar kelyapti..."}),N&&Object(d.jsx)("p",{children:N}),!x&&k.length?Object(d.jsxs)("table",{className:"users__table",children:[Object(d.jsxs)("caption",{className:"users__title",children:["Ro\u2019yxatdan o\u2019tganlar (",k.length,")"]}),Object(d.jsx)("thead",{className:"users__header",children:Object(d.jsxs)("tr",{className:"users__row",children:[Object(d.jsx)("th",{className:"users__col users__header-col",children:"Ism va familiya"}),Object(d.jsx)("th",{className:"users__col users__header-col",children:"Telefon raqam"}),Object(d.jsx)("th",{className:"users__col users__header-col",children:"Yosh"}),Object(d.jsx)("th",{className:"users__col users__header-col",children:"Jinsi"})]})}),Object(d.jsx)("tbody",{children:k&&k.map((function(e){return Object(d.jsx)(E,{data:e},e.id)}))})]}):null]})]}),c&&Object(d.jsx)(D,{winners:c,setModalUsers:n})]})};s(36);var F=function(){var e=m(),t=Object(i.a)(e,1)[0],s=Object(l.h)().pathname;return Object(d.jsx)(l.d,{children:t?Object(d.jsxs)(u,{children:[Object(d.jsx)(x,{exact:!0,path:"/",children:Object(d.jsx)(M,{})}),Object(d.jsx)(x,{exact:!0,path:"/users",children:Object(d.jsx)(B,{})})]}):"/login"===s?Object(d.jsx)(p,{exact:!0,path:"/login",children:Object(d.jsx)(z,{})}):Object(d.jsx)(l.a,{to:"/login"})})};r.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(o.a,{children:Object(d.jsx)(h,{children:Object(d.jsx)(F,{})})})}),document.getElementById("root"))}},[[37,1,2]]]);
//# sourceMappingURL=main.249d4b54.chunk.js.map